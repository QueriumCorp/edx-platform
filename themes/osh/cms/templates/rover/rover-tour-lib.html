## By:   Jim Van Riper
##       Lawrence McDaniel
##       lpm0073@gmail.com
##       lawrencemcdaniel.com
##
## Usage:
##         html, CSS and Javascript to generate Rover tours for AM.
##
##         The tour uses LinkedIn's hopscotch which is documented here.
##         http://linkedin.github.io/hopscotch/
##         https://github.com/linkedin/hopscotch
##
##         Note that there have been no commits to hopscotch since June 2017.
##
##
##         shaded backdrop - this is four opaque-ish divs that are moved to surround and thereby
##         highlight the tour target.  This can be handled with each hopscotch step's onShow
##         callback.  Reference for HTML positioning which can be a pain.
##         https://www.kirupa.com/html5/get_element_position_using_javascript.htm

<%namespace name='static' file='../static_content.html'/>

<%block name="header_extras">

<style>
  .super-training-wheel > h2 {
    font-size: 2.25em;
    margin: 25px 0 25px 0;
    font-weight: 900;
    width: 100%;
    text-align: center;
  }
  .super-training-wheel > h3 {
    width: 100%;
    text-align: center;
    font-size: 1.25em !important;
    font-weight: 500 !important;
  }

  div.hopscotch-actions {
    /* action buttons like "Back" and "Next" */
    text-align: center !important;
  }

  .tour-text-slide-body p {
    margin: 25px 0 50px 0;
    font-size: larger;
    /* font-weight: bolder; Dani does not want the body to be bold. */
  }
  .stw-link {
    text-decoration: underline;
    color: #61B2DB;
  }
  /* McDaniel: Jul-2019. Super Training image styling */
  .super-training-wheel {
    width: 700px;
  }
  span.hopscotch-bubble-number {
    display: none !important;
  }
  .hopscotch-bubble.animated.tour-tour1 {
    border: 2px solid rgb(244, 118, 65) !important;
    border-radius: 10px;
  }
  #tour-youtube-video-title > h1 {
    font-size: 2.25em !important;
    font-weight: 900 !important;
  }
  div.hopscotch-bubble h3 {
    font-size: 1.25em !important;
    font-weight: 600 !important;
    padding-bottom: 20px;
    color: #333;
  }
  .tour-bottom-border {
    border-bottom: 1px solid #E5743D;
  }
  div.hopscotch-bubble {
    border: 2px solid #E5743D;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.up {
    top: -18px;
    left: 10px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.up .hopscotch-bubble-arrow {
    border-bottom: 17px solid #ffffff;
    border-left: 17px solid transparent;
    border-right: 17px solid transparent;
    position: relative;
    top: -14px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.up .hopscotch-bubble-arrow-border {
    border-bottom: 17px solid #000000;
    border-bottom: 17px solid rgba(244, 118, 65, 1);
    border-left: 17px solid transparent;
    border-right: 17px solid transparent;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.down {
    bottom: -35px;
    left: 10px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.down .hopscotch-bubble-arrow {
    border-top: 17px solid #ffffff;
    border-left: 17px solid transparent;
    border-right: 17px solid transparent;
    position: relative;
    top: -20px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.down .hopscotch-bubble-arrow-border {
    border-top: 17px solid #000000;
    border-top: 17px solid rgba(244, 118, 65, 1);
    border-left: 17px solid transparent;
    border-right: 17px solid transparent;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.left {
    top: 10px;
    left: -18px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.left .hopscotch-bubble-arrow {
    border-bottom: 17px solid transparent;
    border-right: 17px solid #ffffff;
    border-top: 17px solid transparent;
    position: relative;
    left: 3px;
    top: -34px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.left .hopscotch-bubble-arrow-border {
    border-right: 17px solid #000000;
    border-right: 17px solid rgba(244, 118, 65, 1);
    border-bottom: 17px solid transparent;
    border-top: 17px solid transparent;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.right {
    top: 10px;
    right: -35px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.right .hopscotch-bubble-arrow {
    border-bottom: 17px solid transparent;
    border-left: 17px solid #ffffff;
    border-top: 17px solid transparent;
    position: relative;
    left: -3px;
    top: -34px;
  }
  div.hopscotch-bubble .hopscotch-bubble-arrow-container.right .hopscotch-bubble-arrow-border {
    border-left: 17px solid #000000;
    border-left: 17px solid rgba(244, 118, 65, 1);
    border-bottom: 17px solid transparent;
    border-top: 17px solid transparent;
  }
  button.hopscotch-nav-button.prev.hopscotch-prev,
  button.hopscotch-nav-button.next.hopscotch-next {
    background: initial;
    color: white;
    font-weight: bold;
    font-size: larger;
    text-shadow: initial;
    background-color: #E5743D;
    border: none;
    width: 175px;
    height: 50px;
  }
  button.hopscotch-nav-button.prev.hopscotch-prev:hover,
  button.hopscotch-nav-button.next.hopscotch-next:hover {
    background: initial;
    background-color: #076e7d;
  }
  /* McDaniel jul-2019: removing the original 50px left margin that was placed to accomodate the rover head. */
  div.hopscotch-bubble .hopscotch-bubble-content {
    /* margin: 0 0 0 50px; */
    margin: 0 0 0 0;
  }
</style>
</%block>



<%block name="jsextra">


<script>
  ##--------------------------------------------------------
  ##  McDaniel Sep-2019
  ##  Setup basic cookie management to store state information about tours taken
  ##--------------------------------------------------------
  function roverSetCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    var expires = "expires="+d.toUTCString();
    var s = cname + "=" + cvalue + ";" + expires + ";path=/";
    document.cookie = s;
  }
  function roverGetCookie(cname, default_value="") {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i = 0; i < ca.length; i++) {
      var c = ca[i];
      while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }
    }
    return default_value;
  }
  function hopscotchState(tour, stage) {
    if (true) {
      console.info(tour, stage, ' - hopscotch.getCurrTour()', hopscotch.getCurrTour());
      console.info(tour, stage, ' - hopscotch.getCurrStepNum()', hopscotch.getCurrStepNum());
      console.info(tour, stage, ' - hopscotch.getState()', hopscotch.getState());
    }
  }
  ## mcdaniel sep-2019
  ## for App user profile menu. To initialize the "Show Page Tips" toggle menu
  function initPageTips() {
    if (roverGetCookie("pageTips", "true") == "true") {
      $( "#ShowPageTips" ).text("Hide Page Tips")
    } else {
      $( "#ShowPageTips" ).text("Show Page Tips")
    }
  }
  ## mcdaniel sep-2019
  ## for App user profile menu. To toggle the "Show Page Tips" menu
  function togglePageTips() {
    if (roverGetCookie("pageTips", "true") == "true") {
      roverSetCookie("pageTips", "false", 365);
      $( "#ShowPageTips" ).text("Show Page Tips")
    } else {
      roverSetCookie("pageTips", "true", 365);
      $( "#ShowPageTips" ).text("Hide Page Tips")
    }
  }
  ## mcdaniel sep-2019
  ## for App user profile menu. To determine whether to show "Page Tips"
  function showPageTips() {
    if (roverGetCookie("pageTips", "true") == "true") {
      console.info("showPageTips() - True");
      return true;
    }
    console.info("showPageTips() - False");
    return false;
  }
  function isSameUrl(url1, url2) {
    console.info('isSameUrl() - ', url1 == url2, url1, url2)

    ## lower case both strings
    url1 = url1.toLowerCase();
    url2 = url2.toLowerCase();

    ## remove training '/' if it exists
    if (url1.endsWith('/')) {
      url1 = url1.substring(0, url1.length-1);
    }
    if (url2.endsWith('/')) {
      url2 = url2.substring(0, url2.length-1);
    }
    console.info('isSameUrl() - ', url1 == url2, url1, url2)
    return url1 == url2;
  }
  function yetSeen(cname) {
    var seen = roverGetCookie(cname);
    if (seen == "true") {
        console.info(cname, "yetSeen() - True");
        return true;
    }
    console.info(cname, "yetSeen() - False");
    return false;
  }
  function shouldShowTour(tour) {
    retval = (!yetSeen(tour) || showPageTips());
    console.info("shouldShowTour()", tour, retval);
    return (!yetSeen(tour) || showPageTips())
  }
  function textSlideHTML(id, title, body) {
    var html = `
      <div id="` + id + ` class="tour-text-slide tour-bottom-border">
       <div class="tour-text-slide-title">
         <h3 class="tour-bottom-border">` + title + `</h3>
       </div>
       <div class="tour-text-slide-body">
         <p>` + body + `</p>
       </div>
     </div>
    `
    return html
  }

function stwWhatCanYouDoHTML() {
  var img1 = "${static.url('images/super-training-wheels-web-icons-04.svg')}";
  var img2 = "${static.url('images/super-training-wheels-web-icons-05.svg')}";
  var img3 = "${static.url('images/super-training-wheels-web-icons-06.svg')}";
  var img4 = "${static.url('images/super-training-wheels-web-icons-07.svg')}";

  var html = `
    <style>
      #super-training-wheel-1 {
        padding: 0 30px 0 30px;
      }
      #super-training-wheel-1 > div > div {
        width: 100%;
        text-align: center;
      }
      #super-training-wheel-1 > div > div > img {
        height: 100px;
        width: 150px;
        margin: 0;
        padding: 0;
        margin-bottom: 10px;
      }
      #super-training-wheel-1 > div > div > p {
        font-weight: normal;
        margin: 0 20px 0 20px;
      }
      #super-training-wheel-1 .columns {
        margin: 25px 0 50px 0;
        height: 150px;
      }
      #super-training-wheel-1 .columns div {
        display: inline-block;
        float: left;
        width: 25%;
      }
    </style>
    <div id="super-training-wheel-1" class="super-training-wheel">
      <h2>What can you do in Rover?</h2>
      <h3>Test drive all the features, create a course.</h3>
      <div class="columns">
        <div class="column">
          <img class="super-training-wheel" src="` + img1 + `" alt="super training wheel 1" />
          <p>Try all the features.</p>
        </div>
        <div class="column">
          <img class="super-training-wheel" src="` + img2 + `" alt="super training wheel 2" />
          <p>View analytics with sample student data.</p>
        </div>
        <div class="column">
          <img class="super-training-wheel" src="` + img3 + `" alt="super training wheel 3" />
          <p>Browse assignments and questions.</p>
        </div>
        <div class="column">
          <img class="super-training-wheel" src="` + img4 + `" alt="super training wheel 4" />
          <p>Setup a real course.</p>
        </div>
      </div>
    </div>
    `
  return html

}

/*
  mcdaniel jul-2019
  super training wheel #2 with embedded youtube video orientation
*/
function stwVideoHTML() {
  var html = `
    <style>
      #tour-video {
        padding: 0 30px 0 30px;
        margin: 15px 0 15px 0;
        text-align: center;
      }
      #tour-video-content {
        margin: inherit;
      }
    </style>
    <div id="tour-video" class="super-training-wheel">
     <h2>Rover quickstart video</h2>
     <h3>Watch our getting started video and learn how to use Rover</h3>
     <div id="tour-video-content">
       ## wistia embed code - begin
       <ifr` + `ame src="https://fast.wistia.net/embed/iframe/fnaf93c3ql?seo=false" title="instructor getting started part one Video" allowtransparency="true" frameborder="0" scrolling="no" class="wistia_embed" name="wistia_embed" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen width="640" height="360"></if` + `rame>
       <sc` + `ript src="https://fast.wistia.net/assets/external/E-v1.js" async></scr` + `ipt>
       ## wistia embed code - end
     </div>
     <div class="tour-video-links" style="margin: inherit;">
       <p>
         <a class="stw-link" href="https://d3bxy9euw4e147.cloudfront.net/oscms-prodcms/media/documents/Rover_instructor_getting_started_guide.pdf" target="_blank">Download the getting started guide</a> or <a class="stw-link" href=" https://openstax.org/general/rover-onboarding" target="_blank">watch the tutorial in a new window</a>
       </p>
     </div>
   </div>
  `
  return html
}
</script>
</%block>
